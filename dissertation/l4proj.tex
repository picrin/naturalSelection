\documentclass{l4proj}

\usepackage{url}
\usepackage{fancyvrb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage[final]{pdfpages}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage[toc]{glossaries}
\usepackage[style=authoryear, backend=biber]{biblatex}
\addbibresource{l4proj.bib}
\makeglossaries
\glstoctrue

%explain homozygous, heterozygous, dominant, sweep, polymorphism example of polymorphism: impression of bitterness while eating brussel sprouts, linkage equilibrium, panmictic population, allele, epigenetics, probability density function.
%\fi

\newglossaryentry{homozygous}{
  name=homozygous,
  description={A homozygous individual possesses two identical alleles of a gene, either both encoding a given trait or the lack of it. A homozygous individual without a given trait is called homozygous recessive for that trait. A homozygous individual with a given trait is called homozygous dominant}
}

\newglossaryentry{selective sweep}{
  name=selective sweep,
  description={When natural selection exerts positive or negative selective pressure on individuals possessing a given trait the alleles encoding this trait will respectively dominate the population or disappear from the population. The process is referred to as selective sweep.}
}

\newglossaryentry{heterozygous}{
  name=heterozygous,
  description={A heterozygous individual possess two different alleles of a gene, one of which encodes a given trait, and one of which encodes a lack of the trait}
}

\newglossaryentry{dominant}{
  name=dominant,
  description={A dominant inheritance scheme is a scheme in which individuals possessing one or two copies of a gene encoding the trait exhibit the trait. An individual can be called homozygous dominant for a trait if it is homozygous and possesses the trait}
}

\newglossaryentry{recessive}{
  name=recessive,
  description={The recessive inheritance scheme is a scheme in which only individuals possessing two copies of a gene encoding the trait exhibit the trait. An individual can be called homozygous dominant for a trait if it is homozygous and it does not possess the trait}
}


\newglossaryentry{autosomal}{
  name=autosomal,
  description={An autosomal gene is located on one of the numbered chromosomes (as opposed to the sex chromosomes). Organisms typically have a pair of autosomal chromosomes, one from the mother and one from the father}
}

\newglossaryentry{polyploid}{
  name=polyploid,
  description={Most organisms have only two versions of each autosomal gene. Some organisms have 4, 6, 8 or more copies of each gene. Such organisms are called polyploid organisms}
}

\newglossaryentry{chromosome}{
  name=chromosome,
  description={chromosome is a collections of genes. Organisms usually have several chromosomes, usually classified into numbered chromosmes, which host autosomal genes, and sex chromosomes, which host sex-linked genes}
}


\newglossaryentry{sex-linked}{
  name=sex-linked,
  description={A sex-linked gene is located on one of the sex chromosomes (as opposed to one of the numbered chromosomes). Organisms usually have either one or two copies of sex-linked genes, depending on the sex}
}

\newglossaryentry{allele}{
  name=allele,
  description={A version of a gene. Each gene can have one or multiple alleles. Existence of many gene versions is the reason for variety within population. Some alleles can corrupt normal body function and result in disease}
}

\newglossaryentry{population graph}{
  name=population graph,
  description={A population graph $G_{p} = (V, E)$ is a Directed Acyclic Graph, where $V$ is the set of all simulated individuals, dead or alive, and $E$ is a collection of all pairs of sims $(u, v)$ such that $u$ is a parent of $v$}
}

\newglossaryentry{locus}{
  name=locus,
  plural={loci},
  description={A placeholder for a gene. Locus is situated on a chromosome and can hold a version of the gene -- see \gls{allele}. If the locus is situated on one of the numbered chromosomes, the gene is called \gls{autosomal}. If the gene is on one of the sex chromosomes, the gene is called \gls{sex-linked}}
}

\newtheorem*{quest}{Research Question}
\newtheorem{assum}{Assumption}
\newcommand{\Tmrca}{T\raisebox{-.4ex}{\scriptsize MRCA}}
\newcommand{\genotype}[2]{\ensuremath{(\mathrm{#1}, \mathrm{#2})}}

\renewcommand*{\glstextformat}{\textbf}

\newif\ifdebug

\debugfalse

\lstset{basicstyle=\ttfamily\footnotesize,breaklines=true}


\begin{document}

\title{The effect of natural selection on relatedness in randomly mating population}
\author{Adam Kurkiewicz}
\date{March 24, 2016}
\maketitle

\begin{abstract}

A flexible population simulation framework is designed and implemented in Python. The framework allows to simulate biological populations, whose evolution is specified by the user, through implementing python functions defining desired breeding, mating, mutation, migration and inheritance schemes. The effect of running each simulation is a file containing a complete information on the entire history of the population, including genotypes of all simulated individuals, parent-child relationships, the generation number each sim belonged to when alive, and the location it occupied. A file created in such way is processed algorithmically and statistically in order to answer the research question: Does natural selection affect relatedness in a species? While we fail to reach a definite conclusion using the methods employed, the areas for furhter investigation are proposed.

\end{abstract}

\educationalconsent

\tableofcontents
%==============================================================================
\chapter{Introduction}
\label{intro}

\ifdebug
  Introduction. This should place the work in context and will be developed from the introduction produced for assessment.
\fi

\pagenumbering{arabic}

\section{Context of the work}

The publication of ``On the Origin of Species'' \parencite{darwin59} is generally accepted to be a founding stone of still vigorously researched field of evolutionary biology. Over the years, as the understanding of the field deepened, it became clear that certain scientific questions within the field can only be answered by obtaining progress in related fields, like establishing laws governing inheritance (genetics) \parencite{mendel}, understanding the role of organic molecules in the process of inheritance (molecular biology) \parencite{watson53}, understanding population dynamics of predator-prey system using both continuous and discrete methods (mathematical biology), understanding the character of population variability at molecular level (neutral theory of molecular evolution, Markov processes) \parencite{kimura68, dayhoff73}, studying of historical populations (archaeology, anthropology, linguistics) \parencite{dubois}, proposing and verifying hypotheses about populations based on quantitative evidence (statistics) \parencite{bronzeAgeEurasia}, modeling and simulating biological systems \textit{in silico} (systems biology), and many others.

While the research presented in this work falls within the realm of computational biology, when referring to other, connected fields we might occasionally need specialized jargon. A glossary of technical terms in use is included at the end of this work. Throughout the text words and phrases in bold (e.g. \gls{autosomal}) are explained in the glossary.

\section{Research question}\label{TMRCA}
The scientific question that we will try to answer in this piece of work is directly connected with evolution by natural selection and perhaps might have even occurred to Darwin himself:

\begin{quest}
Does natural selection affect relatedness in a species? Are individuals in a species under selective pressure more likely to be closely related?
\end{quest}

We will seek to answer this question using a computer simulation. First, we have to decide on how to measure relatedness. We will follow \cite{rohde04} and focus on computing time (in generations) that is taken for a group of simulated individuals to reach a Most Recent Common Ancestor (MRCA). More precisely, we will speak of a \gls{population graph}, which we will define to be a Directed Acyclic Graph (DAG), with vertices representing all individuals ever alive and directed edges representing the parent-child relationship between individuals. Additionally, each vertex will be labeled with complete information on individual's traits. For any point in time all individuals capable of inter-breeding at that point will be referred to as ``generation at time $t$'', or simply ``generation'', if the time can be inferred from the context. An MRCA of a generation at time $t$ will be a common ancestor which is the most recent, i.e. precedes the population by the least number of generations. The time (in generations) that is taken to reach such individual will be denoted by $T_{MRCA}$.

There are other, auxiliary questions we will have to answer on our way. Most crucially we will have to decide on such important details of our simulation as the mating scheme, migration, competition for resource, survivability, number of offspring, etc. Often we will be able to use the choices of parameters already made by others, e.g. breeding scheme \parencite{peng10}. The choice of the parameters is discussed in chapter \ref{research}, along with the appropriate methodology, to which we prepare ground in chapter \ref{review}. We discuss the architecture of the computer program which constitutes the solution, and is on its own a valuable contribution to the field in chapter \ref{practical}. The results are presented in chapter \ref{practical} and the conclusions will be drawn in chapter \ref{conclusion}.

\chapter{Review of the field}\label{review}

\ifdebug
  This should be a critical survey of the relevant literature, adhering to normal academic conventions in citing references, etc. Here I need to discuss coalescent method vs. forward-in time method vs. sample-based methods.

explain trait, explain mendelian genetics, explain homozygous, heterozygous, dominant, sweep, polymorphism example of polymorphism: impression of bitterness while eating brussel sprouts, linkage equilibrium, panmictic population, allele, epigenetics, probability density function.
\fi

\section{Basic inheritance}

Presented work is by no means the first attempt at quantitative study of population genetics. What follows is a review of the most relevant achievements in the field.

\subsection{Early days}
Ever since three European scientist simultaneously and independently rediscovered \& experimentally confirmed Gregor Mendel's theory of inheritance [find the original works of DeVries, Correns and Tscherma, Roberts, H. F. Plant Hybridization before Mendel. Princeton: Princeton University Press, 1929.], the interplay between Mendelian Inheritance and Darwinian Evolution has been hotly debated. One claim popular at the time has fallaciously asserted that Mendelian Genetics cannot be a correct model of trait inheritance [cite this guy whose name starts with U]. The reasoning at the core of the claim was that dominant alleles over time sweep the entire population, thus eliminating variation within the population, rendering evolution by natural selection impossible. This misconception was debunked in a very short letter to the editor of ``Science'' by a famous English number theorist \parencite{hardy08}. The letter is a truly master example of a presentation of non-trivial mathematical thought in a manner both rigorous and understandable, even to non-experts. Let us recall Mendel's laws of inheritance before we present Hardy's argument.

\subsection{Mendelian Inheritance}

Let us start by briefly sketching a relevant subset of the laws of Mendelian Inheritance. A more comprehensive reference can be found in an annotated English translation of the original work of Mendel by \cite{mendel}.

Firstly, we will be acting under the assumption that each animal characteristic (trait) is either present, or not present in a given organism because of:
\begin{assum}\label{genotypes}
  possession by this organism of one, two or none copies of a gene encoding this characteristic.
\end{assum}

\begin{assum}\label{dominance}
  the mode of expression of the characteristic, which can be either \gls{dominant} or \gls{recessive}.
\end{assum}

We have to remark that these assumptions may not be obviously true for certain seemingly continuous, partially environment-dependent characteristics such as height, weight or individual's position in the autism spectrum. However experiments using various methods have consistently asserted that ~80\% of human height is inheritable \parencite{heightTwins, heightJustSiblings}. Although the challenge of identifying all genes affecting height is still open, recent progress using a cross-discipline technique called Genome Wide Association Study (GWAS) identified over 40 genes, which contribute 5 percent points towards total height heritability. To play devil's advocate further, it has been recently established that important traits can be acquired and inherited by non-genetic means in both plants \parencite{palmOilKernel}, non-human animals \parencite{dolinoy_maternal_2007} and humans \parencite{yehuda_holocaust_2015}, giving rise to the field of Epigenetics. We shall consider both environmental and epigenetic factors to be outside of the scope of this research. A curious reader is referred to an accessible, popular science discussion of the topic of GWAS, height inheritance and epigenetics by \textcite{GWASDiscussion}. A concerned reader should find assurance in that a great many traits do obey Mendelian's Inheritance straightforwardly. A comprehensive database for human traits, maintained by John Hopkins University at omim.org \parencite{omim16}, finds 24617 such genes using the match-all wildcard $*$, including 22044 \gls{autosomal} genes (as of \date{March 13, 2016}).

Before we proceed let us recall the following, standard notation: if an \gls{allele} encoding a trait is determined to be \gls{dominant} we will represent it with capital letter, e.g. $\mathrm{A}$. In such case a lack of trait will be considered \gls{recessive} and be denoted as $\mathrm{a}$. Under the assumption \ref{genotypes}, we will consider all three possible genotypes: \genotype{A}{A} -- homozygous dominant, \genotype{A}{a} -- heterozygous and \genotype{a}{a} -- homozygous recessive. Of these the first two the genotypes \genotype{A}{A} and \genotype{A}{a} will result in an individual possessing the characteristic. An individual with the last genotype \genotype{a}{a} will not exhibit the trait. Analogously, one can consider a trait inherited recessively, and in such case the above description is true when ``trait'' is mutually exchanged with ``lack of trait'', ``not exhibit the trait'' with ``exhibit the trait'', etc.

Further, we will assume that
\begin{assum}\label{offspring}
  in offspring each of the two alleles present comes from the parents, precisely one from the mother and one from the father. Each of the parent's two alleles has a 50\% chance of being inherited.
\end{assum}
We can use our assumptions \ref{genotypes}, \ref{dominance}, \ref{offspring} to work out that in a specific case of breeding two heterozygous individuals, an \genotype{A}{a} mother and an \genotype{A}{a} father, each individual offspring will have either of 3 possible genotypes with probabilities $\frac{1}{4}$ for \genotype{A}{A}, $\frac{1}{2}$ for \genotype{A}{a} and $\frac{1}{4}$ for \genotype{a}{a}. Table \ref{offspringTable} gives all possible outcomes of breeding all possible genotypes involving one characteristic along with corresponding probabilities. If the desired mode of inheritance is dominant, the reader can interpret \genotype{A}{a} and \genotype{A}{A} as trait-positive and \genotype{a}{a} as trait-negative. For the recessive case, \genotype{a}{a} is trait-positive and both \genotype{A}{A} and \genotype{A}{a} are trait-negative.

\begin{table}[]
    \centering
    \begin{tabular}{cc||c|c|c|}
    \cline{3-5}
     &  & \multicolumn{3}{c|}{mother} \\ \cline{3-5} 
     &  & \genotype{a}{a} & \genotype{A}{a} & \genotype{A}{A} \\ \hline\hline
    \multicolumn{1}{|c|}{father} & \genotype{a}{a} & \genotype{a}{a} 1 & \begin{tabular}[c]{@{}l@{}}\genotype{a}{a} $\frac{1}{2}$ \\ \genotype{A}{a} $\frac{1}{2}$ \end{tabular} & \genotype{A}{a} 1 \\ \cline{2-5} 
    \multicolumn{1}{|l|}{} & \genotype{A}{a} & \begin{tabular}[c]{@{}l@{}}\genotype{a}{a} $\frac{1}{2}$\\ \genotype{A}{a} $\frac{1}{2}$\end{tabular} & \begin{tabular}[c]{@{}l@{}}\genotype{a}{a} $\frac{1}{4}$\\ \genotype{A}{a} $\frac{1}{2}$\\ \genotype{A}{A} $\frac{1}{4}$\end{tabular} & \begin{tabular}[c]{@{}l@{}}\genotype{A}{a} $\frac{1}{2}$\\ \genotype{A}{A} $\frac{1}{2}$\end{tabular} \\ \cline{2-5} 
    \multicolumn{1}{|l|}{} & \genotype{A}{A} & \genotype{A}{a} 1 & \begin{tabular}[c]{@{}l@{}}\genotype{A}{a} $\frac{1}{2}$\\ \genotype{A}{A} $\frac{1}{2}$\end{tabular} & \genotype{A}{A} 1 \\ \hline
    \end{tabular}
    \caption{Possible offspring genotypes with corresponding probabilities}
    \label{offspringTable}
\end{table}

Finally, we have to remark that the assumption \ref{offspring} may not be correct in rare cases of \gls{sex-linked} characteristics (e.g. colour-blindess). This research will focus exclusively on \gls{autosomal} genes.

\subsection{Hardy-Weinberg equilibrium.}

\begin{samepage}
Let us desribe a distribution of genotypes in the population as the ratio of dominant homozygotes to heterozygotes to recessive homozygotes, symbolically $$p:2q:r$$ $2q$ appears in the ratio to ease the computation.
\end{samepage}

The ingenious insight of \cite{hardy08} is in observing that for certain values of $p$, $q$ and $r$, the ratio will stay unchanged from generation to generation; ratios with this property he calls ``stable''. Hardy gives conditions for stability, and shows that ratios that aren't stable converge to ``stable'' ratios as the population develops. Hardy's argument is based on assuming an arbitrary ratio in the parent generation and computing the ratio of the children's generation. He accomplishes that using a table much like \ref{offspringTable}, and then solving a system of three degree-2 polynomials in three indeterminates: $p$, $q$ and $r$. The result, $q^{2}=pr$, is a necessary and sufficient condition for the ratio to be stable. We have to remark a few assumptions made by Hardy for his proof of the stability condition. Namely, the population is assumed to be isolated, randomly mating, it is assumed to be large, and the number of men and women is assumed to be equal. Hardy's argument does not take into account natural selection.

\section{Work of Fischer}

The work of Ronald Fischer had drastic influence on the landcape of both statistics and quantitative biology. Apart from introducing influential statistical terminology (such as the concept of variance, defined as standard deviation squared) [todo quote original Fischer's paper], Fischer gave modern shape to the notion of null hypothesis testing. He also invented a range of statistical methods, such as one-way analysis of variance (ANOVA). On the biological side, Fischer was behind the realisation that sexual selection is comparatively stronger, and more consistent than natural selection. He formulated the concept of Fischerian runaway and proposed the sexy sons hypothesis. His work on coalescent processes gave rise to the coalescent method, which is of interest for the project, as it could be potentially used to answer the research question.

\section{Coalescent method}

The coalescent method, in its most basic form, is used to predict the time (in generations) for any genetic trait to reach the individual it originated from ("coalesce"). The method is usually employed for a group of individuals with unknown predecessor structure, which makes it suitable for use in situations when data regarding only extant individuals is available. Given an extant population, the coalescent method works backwards in time, with generations in hypothetical ancestry assigned probabilities of containing the coalescent. Although in this basic application the coalescent method is relatively straightforward to apply, once natural selection is included the method gets subtle and very complicated, with major difficulties being mathematical in nature. For a comprehensive review, the reader is referred to [include this massive paper "natural selection and the coalescent method"]. 

\section{Forward-Time Modelling}

for this let us echo concerns raised by \cite{peng10}

\section{Population graph}

Write about Rohde and Olsen's work. In particular, write about migration around various islands. Discuss the use of MRCA and IA.

\chapter{Report of research work}\label{research}
This should bring out the insights and new ideas produced by the review and may continue to suggest further practical work, which would test these ideas. Most importantly, the report should clearly state the overall value of the work which has been done - this should not be lost in a welter of detail.

\section{Selective Sweep in Randomly Mating Population}

An experiment was carried out in order to quantify the effect of positive selection on relatedness in a small, randomly mating population. The relatedness was measured using $T_{MRCA}$ (as discussed in chapter \ref{intro}) of a carefully selected generation in this population.

Throughout the experiment randomness was obtained from python's default random module, which implements Mersenne Twister, a good choice of pseudo-randomness for scientific simulations \parencite{Matsumoto98}. Let us explain the experiment's design.

The initial simulation size was set to be 100 sims, of random sex, and uniformly distributed on the unit sphere. One of the sims, chosen at random, was assigned a \gls{heterozygous} genotype. All other sims were assigned \gls{homozygous} recessive genotypes. The chosen mode of gene expression was \gls{dominant}. The presence of a trait in an invidual would give that individual a comparative breeding advantage of 5\% over an individual without the trait. Each subsequent generation of the simulation was obtained as follows. For each sim in the next generation, first parent was chosen at random from the previous generation. The probability of any sim $s$ being chosen as the first parent can be expressed by a formula
$$p(s, S) = \frac{f(s)}{\sum_{s' \in S}^{}f(s')}$$
where $S$ is the set of all sims in the previous generation (including $s$), and $f(s)$, the sim's absolute fitness, is defined by
$$
f(s) = \begin{cases}
  1.05 \text{, if sim $s$ has the trait} \\
  1 \text{, if sim $s$ does not have the trait} \\
\end{cases}
$$
The second parent was chosen to be the closest sim of opposite sex (as measured by the great circle distance on the unit sphere). The number of sims in the next generation was adjusted to be equal to the number of sims in the previous generation. After birth and before mating each sim migrated to a randomly chosen place on the unit sphere. This model closely follows the one described by \cite{peng10}. It differs from the model of \cite{rohde04} by usage of discrete generations (the previous generation dies before the next generation can breed) as opposed to continuous real-life like generations.

The simulation was run until the trait had spread to the entire population or the trait died out. In the former case, the simulation was included in the sample, in the latter case the simulation was discarded. It is worth pointing out that the length of each simulation measured by generations was variable, i.e. it did not always take the same number of generations for a simulation to reach full trait saturation.

The investigated sample consisted of 200 simulation runs of the experiment described above. For each simulation in this sample, a control simulation was generated with the relative advantage of possessing the trait removed (all sims equally likely to become the first parent) and the length in generations equal to that of the corresponding observation from the sample. This had given a control sample of 200 sims.

Both the investigated and the control sample were processed in the following way: for each simulation in either sample a generation exactly in the middle of the simulation (rounded down if the number of generations happened to be odd) was chosen, and $T_{MRCA}$ was computed for this generation.

This had resulted in two samples of 200 non-negative integers each. The table \ref{populationTable} gives some common statistics for these numbers. Looking at the table we can infer that both the sample and the control are actually collections of integers in the interval $[5, 7]$. We expect a lot of repetitions.

\begin{table}[]
    \centering
    \begin{tabular}{|c|c|c|}
    \hline
     & sample & control \\ \hline\hline
     average & 6.415 & 6.37 \\ \hline
     median & 6 & 6 \\ \hline
     mode & 7 & 7 \\ \hline
     min & 5 & 5 \\ \hline
     max & 7 & 7 \\ \hline
    \end{tabular}
    \caption{statistics for Selective Sweep in Randomly Mating Population experiment}
    \label{populationTable}
\end{table}

The null hypothesis was chosen so that both the investigated sample and the control sample $T_{MRCA}$s come from the same distribution. This hypothesis was tested using Mann-Whitney U-test (ties adjusted and continuity corrected) and Kolomogorov-Smirnov (without continuity correction) two sample test. In Table \ref{nullHypothesisTable} we report the p-values.

\begin{table}[]
    \centering
    \begin{tabular}{|c|c|c|}
    \hline
    & Mann-Whitney & Kolomogorov-Smirnov \\ \hline
    p-values & 0.258987 & 0.999987 \\ \hline
    \end{tabular}
    \caption{p-values of null-hypothesis for Selective Sweep in Randomly Mating Population experiment}
    \label{nullHypothesisTable}
\end{table}


\chapter{Report of practical work}\label{practical}
\ifdebug
This section should summarize the practical work done and its results, concentrating on any unusual or original features. Enough detail should be included to assure the reader that the work has been professionally and competently done, and that the results are trustworthy. Any design features, algorithms and data structures of special interest should be described. Documentation to full software engineering standards is not required.
\fi

\section{Natural Selection Framework}
An important contribution of this research work is an implementation of a forward-time population modeling framework. The framework is then used to investigate the research question that we're interested in by focusing on particular population models of our interest. However, the framework does not force its users into any particular choice of the model. A wide range of real-life populations can be modeled by implementing appropriate mutation, breeding, mating, natural selection, migration and inheritance schemes. The schemes are implemented as python functions, and can be glued together using the framework's API into a full population model. This approach is not dissimilar from simuPOP \parencite{peng05}, a particularly successful forward-time simulation framework, which has been used extensively to model populations under selective pressure, for example to model population divergence due to local adaptation \parencite{naturalSelectionSignatures16}. Let us discuss the design of the framework focusing on similarities and differences with simuPOP.

\subsection{High-Level overview}
The central unit of any simulation in the framework is a ``sim''. Sims are computational abstractions of biological individuals. Sims are assigned partners in accordance with a mating scheme, can sexually reproduce with other sims of opposite sex, and produce offspring in accordance with a breeding scheme. Both mating and breeding schemes can be chosen from any provided by the framework or be user-defined. Some mating and breeding schemes are capable of taking into account the individual's relative fitness and therefore can be used to get insights into the process of natural selection. Sims live on the surface of a unit sphere. Each sim after birth is assigned the position of its female parent. After birth and before mating and breeding each sim migrates in accordance with a specified migration scheme. Each sim possess a genome, which is an encoding of that sim's genes.

The set of all sims in the simulation forms the set of vertices $V$ in the \gls{population graph} $G_{p} = (V, E)$. A pair of sims $(u, v)$ belongs to the set of edges $E$ of $G_{p}$ if the sim $u$ is a parent of the sim $v$. It is easily noticed that $G_{p}$ is a DAG, as no sim can be its own ancestor. We call sims capable of interbreeding at time $t$ to be a generation. Like in simuPOP, the framework is designed in such way that generations are discrete, i.e. all sims in the parent generation die before any sims in the children generation are capable of reproduction. This simplifies the construction of the framework.

Finally sims are serialised into json format and output to hard drive for further analysis. The analysis stage consists of computing MRCA of each generation of sims in the population graph.

simuPOP provides most of the same functionality, however there are significant differences between the two programs. Exact comparison is difficult, because simuPOP is mature software in constant development for over a decade, whereas the proposed framework is an effect of 7 months of part-time development.

Most notably, simuPOP does not allow for graph-theoretic analysis of simulated populations, and does not support outputting population graphs into permanent storage for later analysis. Aside from the educational aspect of creating my own framework this was the main reason why the effort was undertaken.

\subsection{Performance}

SimuPOP achieves low memory and CPU footprint by using python's \textit{extension modules}, which allow more direct access to underlying hardware than pure python. However, there are significant drawbacks of using \textit{extension modules}.

Firstly, development is slowed down by higher cognitive burden put on the programmer, as \textit{extension modules} are typically written in C++, which is arguably less user-friendly than pure python. The following snippet of simuPOP's source code serves as good example:

\begin{lstlisting}
PyObject * genoObj = PyTuple_New(alleles.size());
// set value
for (size_t j = 0; j < alleles.size(); ++j)
    PyTuple_SET_ITEM(genoObj, j, PyInt_FromLong(alleles[j]));
return genoObj;
\end{lstlisting}

which could be equivalently expressed in pure python 

\begin{lstlisting}
genoObj = tuple(alleles)
return genoObj    
\end{lstlisting}

\ifdebug

Simon suggests to remove this paragraph.

Secondly, a study correlating error rates with programming languages has shown C++ programmers make more errors than python programmers: [cite error rates: macbeth.cs.ucdavis.edu/lang\_study.pdf]. These results must be treated with a pinch of salt -- correlation does not imply causation and arguably more depends on the quality of the programmer than on the quality of programming language, additionally the methodology of parsing commit messages to detect bug fixes employed by this study is rather experimental.
\fi
Secondly, the use of extension modules limits execution environment of simuPOP to CPython, whereas the framework proposed has been successfully tested both under CPython 2 and 3 (the entire framework), pypi and jython (with exception of the graph analysis module). Using pure python therefore results in much higher portability.

Let us end this note on performance by saying that the performance of the framework is satisfactory for our purpose. Timing one of the simulation scripts (with MRCA analysis) reveals that the simulation of an initial population of 1000 sims for 70 generations accomplishes in under 2 minutes on consumer grade hardware.

\subsection{Genome}
SimuPOP allows for extensive modeling of genomes, such as modeling multiple loci situated on multiple \gls{chromosome}s, even in \gls{polyploid} organisms \parencite{simuPOP16}.

The proposed framework takes much simpler approach consistent with our requirement of investigating a single feature, in its present form allowing for only one \gls{locus} capable of containing only 2 alleles.

\subsection{Migration}
Mine is more accurate because of the unit sphere.

\subsection{Mutations and Inheritance}

\subsection{Natural Selection}

\subsection{Generations}
discrete generations as in simuPOP. This is unlike Rohde and Olhsen.

\subsection{Mating and Breeding}
Depending on 
capture difficulty in random mating -> random fluctuations in population 

\chapter{Conclusion}\label{conclusion}
This section should summarize the work and its significance, comparing practical results with theoretical expectations where appropriate. Suggestions for possible extensions, or research projects arising from the work, may also be included here.

%\chapter{Glossary}
\printglossaries
\printbibliography[heading=bibintoc]
\end{document}
